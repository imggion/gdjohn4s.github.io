<script setup lang="ts">
import { ref, onMounted, nextTick, computed, onUnmounted } from 'vue'
import { projectList, socialLinks, techStack } from '@/defs'
// Note: SVG content extracted from Vue icon components for terminal use

// Terminal themes
interface TerminalTheme {
    name: string
    background: string
    text: string
    prompt: string
    cursor: string
    header: string
    headerText: string
    scrollbar: string
    scrollbarHover: string
}

const themes: Record<string, TerminalTheme> = {
    vscode: {
        name: 'VS Code Dark',
        background: '#1e1e1e',
        text: '#cccccc',
        prompt: '#4ec9b0',
        cursor: '#ffffff',
        header: '#2d2d30',
        headerText: '#cccccc',
        scrollbar: '#424242',
        scrollbarHover: '#4f4f4f'
    },
    classic: {
        name: 'Classic Terminal',
        background: '#000000',
        text: '#00ff00',
        prompt: '#00ff00',
        cursor: '#00ff00',
        header: '#333333',
        headerText: '#00ff00',
        scrollbar: '#444444',
        scrollbarHover: '#666666'
    },
    matrix: {
        name: 'Matrix',
        background: '#0d1117',
        text: '#00ff41',
        prompt: '#00ff41',
        cursor: '#ffffff',
        header: '#21262d',
        headerText: '#00ff41',
        scrollbar: '#30363d',
        scrollbarHover: '#484f58'
    },
    oceanic: {
        name: 'Oceanic',
        background: '#263238',
        text: '#eeffff',
        prompt: '#82aaff',
        cursor: '#ffcc02',
        header: '#37474f',
        headerText: '#eeffff',
        scrollbar: '#546e7a',
        scrollbarHover: '#607d8b'
    }
}

const terminalRef = ref<HTMLElement>()
const currentInput = ref('')
const terminalHistory = ref<Array<{ content: string; isHtml: boolean; isCommand?: boolean }>>([])
const isTyping = ref(false)
const commandHistory = ref<string[]>([])
const historyIndex = ref(-1)

// Loading animation
const isLoading = ref(true)
const currentWaveFrame = ref(0)

// ASCII Wave frames for animation
const waveFrames = [
    `
           -:::::::::::::::::::::::::::::           
       ::::::::::::::::::::::::::::::::::::::       
     ::::::::::::::::::::::::::::::::::::::::::     
   ::::::::::::::::::::::::::::::::::::::::::::::   
  ::::::::::::::::::-%%%%%%%%%%+:::-::::::::::::::  
 ::::::::::::::::=%%%%%%%%%%%%%%%%%=::::::::::::::: 
 :::::::::::::#=%%%%%%%%%%%%%%%%%%%%%#::::::::::::: 
:::::::::::::*%%%%%%%%%%%%%%%%%%%%%%%%*:::::::::::::
:::::::::::+%%%%%%%%%%%%%%%%%%%@@%%@@=*:::::::::::::
::::::::::*%%%%%%%%%@%%%%%@%%%+-@%*%%=::::::::::::::
:::::::::=%%%%%%%@*=@%@*--+-::::::::@-::::::::::::::
:::::::::#%%%%%%%%+:::::::::::::+%%@@@=:::::::::::::
::::::::::=#%%%%%%#::-+%@@%##-:-+::::-+*::::::::::::
:::::::::+#%%%%%%%+:=%-::::::+#*=::*..+=-:::::::::::
::::+@%%%%%%@%%%%%+-#+**=%....+:-#-..=*+::::::::::::
:::%@%%%#****%%%%%#::*.......+-::::=-:*:::::::::::::
:::@%@%%%*****+::-%=:::*..:*=::::::=-:=-::::::::::::
::::%%%%%%***#-+#-::::::::::::-%%%%%%%@*::::::::::::
:::::#%%%%%**#-:=-::::::::::#%%%%@#++#@%::::::::::::
::::::*%%%%#***%=-*=::::::-%%%%===+#*=::::::::::::::
:::::::%%@%@********::::::--:::::::%::::::::::::::::
 ::::::=%%%%##@@%%%%:::::::::::::-*:::::::::::::::: 
 :::::::%%@%%%%@@@%=-:::::::::::::%###*+=:::::::::: 
  :::::::::-::-@@@@@@-::::::::::::#%@%%%%%%@+:::::  
   :::::::=*%%%%@%%%%%%@%*+====+*%%%@%%%%%%%%%%=:   
     :-@@%%%%%@%%%%%%%%%%%%%%%%%%%@%%%%%%%%@%%%     
       %%%@%*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@       
           *%%%%%%%%%%@%%%%%%%%%%%%%%%%%%                                  
  `,
    `
           #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%           
       %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%       
     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%     
   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   
  %%%%%%%%%%%%%%%%%%#::::::::::+%%%%%%%%%%%%%%%%%%  
 %%%%%%%%%%%%%%%%*:::::::::::::::::*%%%%%%%%%%%%%%% 
 %%%%%%%%%%%%%-*:::::::::::::::::::::-%%%%%%%%%%%%% 
%%%%%%%%%%%%%=::::::::::::::::::::::::=%%%%%%%%%%%%%
%%%%%%%%%%%+:::::::::::::::::::..::..*=%%%%%%%%%%%%%
%%%%%%%%%%=:::::::::.:::::.:::+#.:=-:*%%%%%%%%%%%%%%
%%%%%%%%%*:::::::.=*.:.=##+#%%%%%%%%.#%%%%%%%%%%%%%%
%%%%%%%%%-::::::::+%%%%%%%%%%%%%+::...*%%%%%%%%%%%%%
%%%%%%%%%%*-::::::-%%#+:..:--#%#+%%%%#+=%%%%%%%%%%%%
%%%%%%%%%+-:::::::+%*:#%%%%%%+-=*%%=@@+*#%%%%%%%%%%%
%%%%+.::::::.:::::+#-+==*:@@@@+%#-#@@*=+%%%%%%%%%%%%
%%%:.:::-====:::::-%%=@@@@@@@+#%%%%*#%=%%%%%%%%%%%%%
%%%.:.:::=====+%%#:*%%%=@@%=*%%%%%%*#%*#%%%%%%%%%%%%
%%%%::::::===-#+-#%%%%%%%%%%%%#:::::::.=%%%%%%%%%%%%
%%%%%-:::::==-#%*##%%%%%%%%%-::::.-++-.:%%%%%%%%%%%%
%%%%%%=::::-===:*#=*%%%%%%#::::***+-=*%%%%%%%%%%%%%%
%%%%%%%::.:.========%%%%%%##%%%%%%%:%%%%%%%%%%%%%%%%
 %%%%%%*::::--..::::%%%%%%%%%%%%%#=%%%%%%%%%%%%%%%% 
 %%%%%%%::.::::...:*#%%%%%%%%%%%%%:---=+*%%%%%%%%%% 
  %%%%%%%%%#%%#......#%%%%%%%%%%%%-:.::::::.+%%%%%  
   %%%%%%%*=::::.::::::.:=+****+=:::.::::::::::*%   
     %#..:::::.:::::::::::::::::::.::::::::.:::     
       :::.:=:::::::::::::::::::::::::::::::.       
           =::::::::::.::::::::::::::::::                                        
  `,
    `
           -:::::::::::::::::::::::::::::           
       ::::::::::::::::::::::::::::::::::::::       
     ::::::::::::::::::::::::::::::::::::::::::     
   ::::::::::::::::::::::::::::::::::::::::::::::   
  ::::::::::::::::::-%%%%%%%%%%+:::-::::::::::::::  
 ::::::::::::::::=%%%%%%%%%%%%%%%%%=::::::::::::::: 
 :::::::::::::#=%%%%%%%%%%%%%%%%%%%%%#::::::::::::: 
:::::::::::::*%%%%%%%%%%%%%%%%%%%%%%%%*:::::::::::::
:::::::::::+%%%%%%%%%%%%%%%%%%%@@%%@@=*:::::::::::::
::::::::::*%%%%%%%%%@%%%%%@%%%+-@%*%%=::::::::::::::
:::::::::=%%%%%%%@*=@%@*--+-::::::::@-::::::::::::::
:::::::::#%%%%%%%%+:::::::::::::+%%@@@=:::::::::::::
::::::::::=#%%%%%%#::-+%@@%##-:-+::::-+*::::::::::::
:::::::::+#%%%%%%%+:=%-::::::+#*=::*..+=-:::::::::::
::::+@%%%%%%@%%%%%+-#+**=%....+:-#-..=*+::::::::::::
:::%@%%%#****%%%%%#::*.......+-::::=-:*:::::::::::::
:::@%@%%%*****+::-%=:::*..:*=::::::=-:=-::::::::::::
::::%%%%%%***#-+#-::::::::::::-%%%%%%%@*::::::::::::
:::::#%%%%%**#-:=-::::::::::#%%%%@#++#@%::::::::::::
::::::*%%%%#***%=-*=::::::-%%%%===+#*=::::::::::::::
:::::::%%@%@********::::::--:::::::%::::::::::::::::
 ::::::=%%%%##@@%%%%:::::::::::::-*:::::::::::::::: 
 :::::::%%@%%%%@@@%=-:::::::::::::%###*+=:::::::::: 
  :::::::::-::-@@@@@@-::::::::::::#%@%%%%%%@+:::::  
   :::::::=*%%%%@%%%%%%@%*+====+*%%%@%%%%%%%%%%=:   
     :-@@%%%%%@%%%%%%%%%%%%%%%%%%%@%%%%%%%%@%%%     
       %%%@%*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@       
           *%%%%%%%%%%@%%%%%%%%%%%%%%%%%%  
  `,
    `
           #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%           
       %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%       
     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%     
   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   
  %%%%%%%%%%%%%%%%%%#::::::::::+%%%%%%%%%%%%%%%%%%  
 %%%%%%%%%%%%%%%%*:::::::::::::::::*%%%%%%%%%%%%%%% 
 %%%%%%%%%%%%%-*:::::::::::::::::::::-%%%%%%%%%%%%% 
%%%%%%%%%%%%%=::::::::::::::::::::::::=%%%%%%%%%%%%%
%%%%%%%%%%%+:::::::::::::::::::..::..*=%%%%%%%%%%%%%
%%%%%%%%%%=:::::::::.:::::.:::+#.:=-:*%%%%%%%%%%%%%%
%%%%%%%%%*:::::::.=*.:.=##+#%%%%%%%%.#%%%%%%%%%%%%%%
%%%%%%%%%-::::::::+%%%%%%%%%%%%%+::...*%%%%%%%%%%%%%
%%%%%%%%%%*-::::::-%%#+:..:--#%#+%%%%#+=%%%%%%%%%%%%
%%%%%%%%%+-:::::::+%*:#%%%%%%+-=*%%=@@+*#%%%%%%%%%%%
%%%%+.::::::.:::::+#-+==*:@@@@+%#-#@@*=+%%%%%%%%%%%%
%%%:.:::-====:::::-%%=@@@@@@@+#%%%%*#%=%%%%%%%%%%%%%
%%%.:.:::=====+%%#:*%%%=@@%=*%%%%%%*#%*#%%%%%%%%%%%%
%%%%::::::===-#+-#%%%%%%%%%%%%#:::::::.=%%%%%%%%%%%%
%%%%%-:::::==-#%*##%%%%%%%%%-::::.-++-.:%%%%%%%%%%%%
%%%%%%=::::-===:*#=*%%%%%%#::::***+-=*%%%%%%%%%%%%%%
%%%%%%%::.:.========%%%%%%##%%%%%%%:%%%%%%%%%%%%%%%%
 %%%%%%*::::--..::::%%%%%%%%%%%%%#=%%%%%%%%%%%%%%%% 
 %%%%%%%::.::::...:*#%%%%%%%%%%%%%:---=+*%%%%%%%%%% 
  %%%%%%%%%#%%#......#%%%%%%%%%%%%-:.::::::.+%%%%%  
   %%%%%%%*=::::.::::::.:=+****+=:::.::::::::::*%   
     %#..:::::.:::::::::::::::::::.::::::::.:::     
       :::.:=:::::::::::::::::::::::::::::::.       
           =::::::::::.::::::::::::::::::  
  `,
    `
           -:::::::::::::::::::::::::::::           
       ::::::::::::::::::::::::::::::::::::::       
     ::::::::::::::::::::::::::::::::::::::::::     
   ::::::::::::::::::::::::::::::::::::::::::::::   
  ::::::::::::::::::-%%%%%%%%%%+:::-::::::::::::::  
 ::::::::::::::::=%%%%%%%%%%%%%%%%%=::::::::::::::: 
 :::::::::::::#=%%%%%%%%%%%%%%%%%%%%%#::::::::::::: 
:::::::::::::*%%%%%%%%%%%%%%%%%%%%%%%%*:::::::::::::
:::::::::::+%%%%%%%%%%%%%%%%%%%@@%%@@=*:::::::::::::
::::::::::*%%%%%%%%%@%%%%%@%%%+-@%*%%=::::::::::::::
:::::::::=%%%%%%%@*=@%@*--+-::::::::@-::::::::::::::
:::::::::#%%%%%%%%+:::::::::::::+%%@@@=:::::::::::::
::::::::::=#%%%%%%#::-+%@@%##-:-+::::-+*::::::::::::
:::::::::+#%%%%%%%+:=%-::::::+#*=::*..+=-:::::::::::
::::+@%%%%%%@%%%%%+-#+**=%....+:-#-..=*+::::::::::::
:::%@%%%#****%%%%%#::*.......+-::::=-:*:::::::::::::
:::@%@%%%*****+::-%=:::*..:*=::::::=-:=-::::::::::::
::::%%%%%%***#-+#-::::::::::::-%%%%%%%@*::::::::::::
:::::#%%%%%**#-:=-::::::::::#%%%%@#++#@%::::::::::::
::::::*%%%%#***%=-*=::::::-%%%%===+#*=::::::::::::::
:::::::%%@%@********::::::--:::::::%::::::::::::::::
 ::::::=%%%%##@@%%%%:::::::::::::-*:::::::::::::::: 
 :::::::%%@%%%%@@@%=-:::::::::::::%###*+=:::::::::: 
  :::::::::-::-@@@@@@-::::::::::::#%@%%%%%%@+:::::  
   :::::::=*%%%%@%%%%%%@%*+====+*%%%@%%%%%%%%%%=:   
     :-@@%%%%%@%%%%%%%%%%%%%%%%%%%@%%%%%%%%@%%%     
       %%%@%*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@       
           *%%%%%%%%%%@%%%%%%%%%%%%%%%%%%  
  `,
    `
           #%%%%%%%%%%%%%%%%%%%%%%%%%%%%%           
       %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%       
     %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%     
   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%   
  %%%%%%%%%%%%%%%%%%#::::::::::+%%%%%%%%%%%%%%%%%%  
 %%%%%%%%%%%%%%%%*:::::::::::::::::*%%%%%%%%%%%%%%% 
 %%%%%%%%%%%%%-*:::::::::::::::::::::-%%%%%%%%%%%%% 
%%%%%%%%%%%%%=::::::::::::::::::::::::=%%%%%%%%%%%%%
%%%%%%%%%%%+:::::::::::::::::::..::..*=%%%%%%%%%%%%%
%%%%%%%%%%=:::::::::.:::::.:::+#.:=-:*%%%%%%%%%%%%%%
%%%%%%%%%*:::::::.=*.:.=##+#%%%%%%%%.#%%%%%%%%%%%%%%
%%%%%%%%%-::::::::+%%%%%%%%%%%%%+::...*%%%%%%%%%%%%%
%%%%%%%%%%*-::::::-%%#+:..:--#%#+%%%%#+=%%%%%%%%%%%%
%%%%%%%%%+-:::::::+%*:#%%%%%%+-=*%%=@@+*#%%%%%%%%%%%
%%%%+.::::::.:::::+#-+==*:@@@@+%#-#@@*=+%%%%%%%%%%%%
%%%:.:::-====:::::-%%=@@@@@@@+#%%%%*#%=%%%%%%%%%%%%%
%%%.:.:::=====+%%#:*%%%=@@%=*%%%%%%*#%*#%%%%%%%%%%%%
%%%%::::::===-#+-#%%%%%%%%%%%%#:::::::.=%%%%%%%%%%%%
%%%%%-:::::==-#%*##%%%%%%%%%-::::.-++-.:%%%%%%%%%%%%
%%%%%%=::::-===:*#=*%%%%%%#::::***+-=*%%%%%%%%%%%%%%
%%%%%%%::.:.========%%%%%%##%%%%%%%:%%%%%%%%%%%%%%%%
 %%%%%%*::::--..::::%%%%%%%%%%%%%#=%%%%%%%%%%%%%%%% 
 %%%%%%%::.::::...:*#%%%%%%%%%%%%%:---=+*%%%%%%%%%% 
  %%%%%%%%%#%%#......#%%%%%%%%%%%%-:.::::::.+%%%%%  
   %%%%%%%*=::::.::::::.:=+****+=:::.::::::::::*%   
     %#..:::::.:::::::::::::::::::.::::::::.:::     
       :::.:=:::::::::::::::::::::::::::::::.       
           =::::::::::.::::::::::::::::::  
  `,
    `
           -:::::::::::::::::::::::::::::           
       ::::::::::::::::::::::::::::::::::::::       
     ::::::::::::::::::::::::::::::::::::::::::     
   ::::::::::::::::::::::::::::::::::::::::::::::   
  ::::::::::::::::::-%%%%%%%%%%+:::-::::::::::::::  
 ::::::::::::::::=%%%%%%%%%%%%%%%%%=::::::::::::::: 
 :::::::::::::#=%%%%%%%%%%%%%%%%%%%%%#::::::::::::: 
:::::::::::::*%%%%%%%%%%%%%%%%%%%%%%%%*:::::::::::::
:::::::::::+%%%%%%%%%%%%%%%%%%%@@%%@@=*:::::::::::::
::::::::::*%%%%%%%%%@%%%%%@%%%+-@%*%%=::::::::::::::
:::::::::=%%%%%%%@*=@%@*--+-::::::::@-::::::::::::::
:::::::::#%%%%%%%%+:::::::::::::+%%@@@=:::::::::::::
::::::::::=#%%%%%%#::-+%@@%##-:-+::::-+*::::::::::::
:::::::::+#%%%%%%%+:=%-::::::+#*=::*..+=-:::::::::::
::::+@%%%%%%@%%%%%+-#+**=%....+:-#-..=*+::::::::::::
:::%@%%%#****%%%%%#::*.......+-::::=-:*:::::::::::::
:::@%@%%%*****+::-%=:::*..:*=::::::=-:=-::::::::::::
::::%%%%%%***#-+#-::::::::::::-%%%%%%%@*::::::::::::
:::::#%%%%%**#-:=-::::::::::#%%%%@#++#@%::::::::::::
::::::*%%%%#***%=-*=::::::-%%%%===+#*=::::::::::::::
:::::::%%@%@********::::::--:::::::%::::::::::::::::
 ::::::=%%%%##@@%%%%:::::::::::::-*:::::::::::::::: 
 :::::::%%@%%%%@@@%=-:::::::::::::%###*+=:::::::::: 
  :::::::::-::-@@@@@@-::::::::::::#%@%%%%%%@+:::::  
   :::::::=*%%%%@%%%%%%@%*+====+*%%%@%%%%%%%%%%=:   
     :-@@%%%%%@%%%%%%%%%%%%%%%%%%%@%%%%%%%%@%%%     
       %%%@%*%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%@       
           *%%%%%%%%%%@%%%%%%%%%%%%%%%%%%  
  `
]

// Theme management
const currentTheme = ref<string>('vscode')
const theme = computed(() => themes[currentTheme.value])

// Mobile detection
const isMobile = ref(false)

const detectMobile = () => {
    const userAgent = navigator.userAgent.toLowerCase()
    const isTouchDevice = 'ontouchstart' in window || navigator.maxTouchPoints > 0
    const isSmallScreen = window.innerWidth <= 768
    const isMobileUserAgent = /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/.test(
        userAgent
    )

    return isTouchDevice && (isSmallScreen || isMobileUserAgent)
}

const commands: Record<string, (args?: string) => string | { content: string; isHtml: boolean }> = {
    help: () => `Available commands:
  about         - Learn about Giovanni
  projects      - View my projects  
  skills        - Check my tech stack
  contact       - Contact information
  clear         - Clear terminal
  whoami        - Display current user
  ls            - List portfolio contents
  pwd           - Show current directory
  date          - Show current date and time
  font          - Show current font information
  theme         - Change terminal theme
  themes        - List available themes
  icons         - Show available icon components`,

    about: () => `Giovanni D'Andrea
Sometime i write stuff.
    
    ${
        isMobile.value
            ? '🌊 [ASCII Art optimized for desktop viewing]'
            : `                  
                        ***###%                        
                    ******#####%%%%                    
                 **********#####%%%%%%                 
              *************#####%%%%%%%%%              
           ***************######%%%%%%%%%%%@           
         ***************#######%%%%%%%%%%%%%@@         
        ***************######%%%%%%%%%%%%%%@@@@        
        *************######%%%%%%%%%%%%%%%@@@@@        
        **********#######%%%%%%%%%%%%%%%%@@@@@@        
        ********#######%%%%%%%%%%%%%%%%%@@@@@@@            
        ##%%%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@@@@@@        
        %%%%%%%%%%%%%%%%%%%%%%%%@@@@@@@@@@@@@@@        
        %%%%%%%%%%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@        
        %%%%%%%%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@        
         %%%%%%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@         
          %%%%%%%%%%%%%%@@@@@@@@@@@@@@@@@@@@           
              %%%%%@@@@@@@@@@@@@@@@@@@@@@              
                 @@@@@@@@@@@@@@@@@@@@@                 
                    @@@@@@@@@@@@@@@                    
                       @@@@@@@@@                                                                                          
    `
    }

Hi, I'm a software developer with a solid background in systems administration.

I blend disciplined engineering with a relaxed attitude that keeps \ncollaboration smooth and enjoyable. I enjoy turning complex ideas into clean, \ndependable code and stay curious about new tools and practices that raise the bar. 

When I'm not refining product backlogs or automating workflows, you'll \nlikely find me exploring a new city, dialing in the perfect espresso shot, or planning my next hike. 

I'm ambitious, my goal is to change the world through simplicity.. and \nthat's why we made (me and my team) Exastudio.

Simplicity reigns in my approach to development.`,

    projects: () => {
        let output = 'My Projects:\n'
        projectList.forEach((project, index) => {
            output += `\n[${index + 1}] ${project.name}
    Description: ${project.description}
    Link: ${createLink(project.linkTo.toString())}\n`
        })
        return { content: output, isHtml: true }
    },

    skills: () => {
        let output = 'Tech Stack:\n'
        techStack.forEach((tech) => {
            output += `${getTerminalIcon(tech.name)}\n`
        })
        return { content: output, isHtml: true }
    },

    contact: () => {
        return {
            content: `Contact Information:
  Email: ${createLink('mailto:giovanni@exastudio.io', 'giovanni@exastudio.io')}
  X (Formerly Twitter): ${createLink('https://x.com/imggion')}
  GitHub: ${createLink('https://github.com/imggion')}
  LinkedIn: ${createLink('https://www.linkedin.com/in/giovanni-d-andrea-b3b456111/')}`,
            isHtml: true
        }
    },

    clear: () => {
        terminalHistory.value = []
        return ''
    },

    whoami: () => 'imggion',

    ls: () => `total 4
drwxr-xr-x  2 imggion  staff   64 Dec  2024 about/
drwxr-xr-x  2 imggion  staff   96 Dec  2024 projects/
drwxr-xr-x  2 imggion  staff   48 Dec  2024 social/
-rw-r--r--  1 imggion  staff  512 Dec  2024 contact.txt
-rw-r--r--  1 imggion  staff  256 Dec  2024 skills.txt`,

    pwd: () => '/home/imggion/portfolio',

    date: () => new Date().toString(),

    font: () => {
        const computedStyle = window.getComputedStyle(document.body)
        const fontFamily = computedStyle.getPropertyValue('font-family')
        return `Current font family: ${fontFamily}\n\nTest text (JetBrains Mono): abcdefghijklmnopqrstuvwxyz\nTest text (Symbols): 0123456789 !@#$%^&*()_+-=[]{}|;:,.<>?`
    },

    themes: () => {
        let output = 'Available themes:\n'
        Object.entries(themes).forEach(([key, theme]) => {
            const indicator = key === currentTheme.value ? ' (current)' : ''
            output += `• ${key} - ${theme.name}${indicator}\n`
        })
        output += '\nUse "theme <name>" to switch themes'
        return output
    },

    icons: () => {
        let output = 'Available Custom Icons:\n'
        Object.entries(customSvgIcons).forEach(([key, config]) => {
            output += `${config.svg}<span style="color: ${config.color}; font-weight: 500;">${config.name}</span> - "${key}"\n`
        })
        output += '\nThese icons use SVG content from Vue icon components!'
        return { content: output, isHtml: true }
    },

    theme: (args: string = '') => {
        const themeName = args.trim().toLowerCase()
        if (!themeName) {
            return `Current theme: ${themes[currentTheme.value].name}\nUse "themes" to see available themes`
        }
        if (themeName in themes) {
            currentTheme.value = themeName
            localStorage.setItem('terminal-theme', themeName)
            return `Theme changed to: ${themes[themeName].name}`
        }
        return `Theme "${themeName}" not found. Use "themes" to see available themes`
    }
}

const typeWriter = async (text: string, delay = 30) => {
    isTyping.value = true
    for (let i = 0; i <= text.length; i++) {
        currentInput.value = text.slice(0, i)
        await new Promise((resolve) => setTimeout(resolve, delay))
    }
    isTyping.value = false
}

const executeCommand = (cmd: string) => {
    const trimmedCmd = cmd.trim()
    const [command, ...args] = trimmedCmd.toLowerCase().split(' ')
    const argsString = args.join(' ')

    terminalHistory.value.push({ content: createPrompt(cmd), isHtml: true, isCommand: true })

    // Add to command history if not empty
    if (cmd.trim() !== '') {
        commandHistory.value.push(cmd.trim())
        historyIndex.value = -1
    }

    if (command in commands) {
        const output = commands[command](argsString)
        if (output) {
            if (typeof output === 'string') {
                terminalHistory.value.push({ content: output, isHtml: false, isCommand: false })
            } else {
                terminalHistory.value.push({ ...output, isCommand: false })
            }
        }
    } else if (command === '') {
        // Empty command, do nothing
    } else {
        terminalHistory.value.push({
            content: `Command not found: ${command}. Type 'help' for available commands.`,
            isHtml: false,
            isCommand: false
        })
    }

    currentInput.value = ''
    nextTick(() => {
        if (terminalRef.value) {
            terminalRef.value.scrollTop = terminalRef.value.scrollHeight
        }
    })
}

const handleKeyPress = (event: KeyboardEvent) => {
    if (isTyping.value) return

    if (event.key === 'Enter') {
        executeCommand(currentInput.value)
    } else if (event.key === 'Backspace') {
        currentInput.value = currentInput.value.slice(0, -1)
    } else if (event.key === 'ArrowUp') {
        event.preventDefault()
        if (commandHistory.value.length > 0) {
            if (historyIndex.value === -1) {
                historyIndex.value = commandHistory.value.length - 1
            } else if (historyIndex.value > 0) {
                historyIndex.value--
            }
            currentInput.value = commandHistory.value[historyIndex.value] || ''
        }
    } else if (event.key === 'ArrowDown') {
        event.preventDefault()
        if (historyIndex.value !== -1) {
            if (historyIndex.value < commandHistory.value.length - 1) {
                historyIndex.value++
                currentInput.value = commandHistory.value[historyIndex.value] || ''
            } else {
                historyIndex.value = -1
                currentInput.value = ''
            }
        }
    } else if (event.key.length === 1) {
        currentInput.value += event.key
    }
}

const focusTerminal = () => {
    // Focus the terminal for keyboard input
    if (terminalRef.value) {
        terminalRef.value.focus()
    }
}

const handleResize = () => {
    isMobile.value = detectMobile()
}

// Helper function to create clickable links
const createLink = (url: string, text?: string) => {
    const linkText = text || url
    return `<a href="${url}" target="_blank" rel="noopener noreferrer" class="terminal-link">${linkText}</a>`
}

// Helper function to create styled prompt
const createPrompt = (cmd: string) => {
    return `<span style="color: ${theme.value.prompt}; font-weight: 500;">imggion@portfolio:~$</span> <span style="color: ${theme.value.text};">${cmd}</span>`
}

// Custom SVG icon mapping with actual SVG content from Vue components
const customSvgIcons: Record<string, { svg: string; color: string; name: string }> = {
    vue: {
        svg: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" style="display: inline-block; vertical-align: middle; margin-right: 6px;">
            <g fill="none">
                <path fill="#4FC08D" d="M20.138 4.193a1 1 0 0 1 1.777.91l-.053.104l-9 15.3a1 1 0 0 1-1.659.097l-.065-.097l-9-15.3a1 1 0 0 1 1.659-1.111l.065.097L12 18.028zm-4.294 0a1 1 0 0 1 1.777.91l-.053.104l-4.706 8a1 1 0 0 1-1.659.097l-.065-.097l-4.706-8a1 1 0 0 1 1.66-1.111l.064.097L12 10.728z"></path>
            </g>
        </svg>`,
        color: '#4FC08D',
        name: 'Vue'
    },
    python: {
        svg: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" style="display: inline-block; vertical-align: middle; margin-right: 6px;">
            <path fill="#3776AB" d="M19.14 7.5A2.86 2.86 0 0 1 22 10.36v3.78A2.86 2.86 0 0 1 19.14 17H12c0 .39.32.96.71.96H17v1.68a2.86 2.86 0 0 1-2.86 2.86H9.86A2.86 2.86 0 0 1 7 19.64v-3.75a2.85 2.85 0 0 1 2.86-2.85h5.25a2.85 2.85 0 0 0 2.85-2.86V7.5zm-4.28 11.79c-.4 0-.72.3-.72.89c0 .59.32.71.72.71a.71.71 0 0 0 .71-.71c0-.59-.32-.89-.71-.89m-10-1.79A2.86 2.86 0 0 1 2 14.64v-3.78A2.86 2.86 0 0 1 4.86 8H12c0-.39-.32-.96-.71-.96H7V5.36A2.86 2.86 0 0 1 9.86 2.5h4.28A2.86 2.86 0 0 1 17 5.36v3.75a2.85 2.85 0 0 1-2.86 2.85H8.89a2.85 2.85 0 0 0-2.85 2.86v2.68zM9.14 5.71c.4 0 .72-.3.72-.89c0-.59-.32-.71-.72-.71c-.39 0-.71.12-.71.71s.32.89.71.89"></path>
        </svg>`,
        color: '#3776AB',
        name: 'Python'
    },
    rust: {
        svg: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" style="display: inline-block; vertical-align: middle; margin-right: 6px;">
            <path fill="#CE422B" d="m21.9 11.7l-.9-.5V11l.7-.7c.1-.1.1-.3 0-.4l-.1-.1l-.9-.3c0-.1 0-.2-.1-.2l.6-.8c.1-.1.1-.3-.1-.4c0 0-.1 0-.1-.1l-1-.2c0-.1-.1-.1-.1-.2l.4-.9v-.3c-.1-.1-.2-.1-.3-.1h-1s0-.1-.1-.1l.2-1c0-.2-.1-.3-.2-.3h-.1l-1 .2c0-.1-.1-.1-.2-.2v-1c0-.2-.1-.3-.3-.3h-.1l-.9.4h-.1L16 3c0-.2-.2-.3-.3-.2h-.1l-.8.6c-.1 0-.2 0-.2-.1l-.3-.9c-.1-.1-.2-.2-.4-.2c0 0-.1 0-.1.1L13 3h-.2l-.5-.8c-.1-.2-.3-.2-.5-.2l-.1.1l-.5.9H11l-.7-.7c-.1-.1-.3-.1-.4 0l-.1.1l-.3.9c-.1 0-.2 0-.2.1l-.8-.6c-.2-.1-.4-.1-.5.1V3l-.2 1s-.1 0-.2.1l-.9-.4c-.1-.1-.3 0-.4.1v1.1c0 .1-.1.1-.1.2l-1-.2c-.2-.1-.3 0-.3.2v.1l.2 1c-.1 0-.1.1-.2.1h-1c-.2 0-.3.1-.3.3v.1l.4.9v.2L3 8c-.2 0-.3.2-.3.3v.1l.6.8c0 .1 0 .2-.1.2l-.8.4c-.1.1-.2.2-.2.4c0 0 0 .1.1.1l.7.7v.2l-.8.5c-.2.1-.2.3-.2.4l.1.1l.9.6v.2l-.7.7c-.1.1-.1.3 0 .4l.1.1l.9.3c0 .1 0 .2.1.2l-.6.8c-.1.1-.1.3.1.4c0 0 .1 0 .1.1l1 .2c0 .1.1.1.1.2l-.4.9c-.1.1 0 .3.1.4h1.1c.1 0 .1.1.2.1l-.2 1c0 .2.1.3.2.3h.1l1-.2c0 .1.1.1.2.2v1c0 .2.1.3.3.3h.1l.9-.4h.1l.2 1c0 .2.2.3.3.2h.1l.8-.6c.1 0 .2 0 .2.1l.3.9c.1.1.2.2.4.2c0 0 .1 0 .1-.1l.8-.7h.2l.5.8c.1.1.3.2.4.1l.1-.1l.5-.8h.2l.7.7c.1.1.3.1.4 0l.1-.1l.3-.9c.1 0 .2 0 .2-.1l.8.6c.1.1.3.1.4-.1c0 0 0-.1.1-.1l.2-1c.1 0 .1-.1.2-.1l.9.4c.1.1.3 0 .4-.1v-1.1l.2-.2l1 .2c.2 0 .3-.1.3-.2v-.1l-.2-1l.2-.2h1c.2 0 .3-.1.3-.3v-.1l-.4-.9c0-.1.1-.1.1-.2l1-.2c.2 0 .3-.2.2-.3v-.1l-.6-.8l.1-.2l.9-.3c.1-.1.2-.2.2-.4c0 0 0-.1-.1-.1L21 13v-.2l.8-.5c.2-.1.2-.3.1-.6c0 .1 0 .1 0 0m-5.7 7c-.3-.1-.5-.4-.5-.7c.1-.3.4-.5.7-.5c.3.1.5.4.5.7c0 .4-.3.6-.7.5m-.2-1.9c-.3-.1-.6.1-.6.4l-.4 1.4c-.9.4-1.9.6-3 .6s-2.1-.2-3.1-.7l-.3-1.4c-.1-.3-.3-.5-.6-.4l-1.2.3c-.2-.2-.4-.5-.6-.7h6c.1 0 .1 0 .1-.1v-2.1c0-.1 0-.1-.1-.1h-1.7v-1.3h1.9c.2 0 .9 0 1.2 1c.1.3.2 1.3.4 1.6c.1.3.6 1 1.1 1h3.1c-.2.3-.4.5-.7.8zm-8.3 1.9c-.3.1-.6-.1-.7-.5c-.1-.3.1-.6.5-.7s.6.1.7.5c0 .3-.2.6-.5.7M5.4 9.5c.1.3 0 .7-.3.8c-.3.1-.7 0-.8-.3c-.1-.3 0-.7.3-.8c.4-.1.7 0 .8.3m-.7 1.6l1.3-.5c.3-.1.4-.4.3-.7L6 9.3h1V14H5c-.3-1-.4-1.9-.3-2.9m5.6-.4V9.3h2.5c.1 0 .9.1.9.7c0 .5-.6.7-1.1.7zm9 1.2v.5h-.8c-.1 0-.1 0-.1.1v.3c0 .8-.5 1-.9 1s-.8-.2-.9-.4c-.2-1.3-.6-1.5-1.2-2c.7-.5 1.5-1.2 1.5-2.1c0-1-.7-1.6-1.1-1.9c-.7-.4-1.4-.5-1.6-.5H6.6c1.1-1.2 2.5-2 4.1-2.3l.9 1c.2.2.5.2.8 0l1-1c2.1.4 3.9 1.7 5 3.6l-.7 1.6c-.1.3 0 .6.3.7l1.3.6zm-7.7-8c.2-.2.6-.2.8 0c.2.2.2.6 0 .8c-.3.3-.6.3-.9 0c-.2-.2-.1-.5.1-.8m6.9 5.6c.1-.3.5-.4.8-.3c.3.1.4.5.3.8c-.1.3-.5.4-.8.3c-.3-.1-.4-.5-.3-.8"></path>
        </svg>`,
        color: '#CE422B',
        name: 'Rust'
    },
    github: {
        svg: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" style="display: inline-block; vertical-align: middle; margin-right: 6px;">
            <g fill="none">
                <path fill="#181717" d="M7.024 2.31a9.08 9.08 0 0 1 2.125 1.046A11.432 11.432 0 0 1 12 3c.993 0 1.951.124 2.849.355a9.08 9.08 0 0 1 2.124-1.045c.697-.237 1.69-.621 2.28.032c.4.444.5 1.188.571 1.756c.08.634.099 1.46-.111 2.28C20.516 7.415 21 8.652 21 10c0 2.042-1.106 3.815-2.743 5.043a9.456 9.456 0 0 1-2.59 1.356c.214.49.333 1.032.333 1.601v3a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-.991c-.955.117-1.756.013-2.437-.276c-.712-.302-1.208-.77-1.581-1.218c-.354-.424-.74-1.38-1.298-1.566a1 1 0 0 1 .632-1.898c.666.222 1.1.702 1.397 1.088c.48.62.87 1.43 1.63 1.753c.313.133.772.22 1.49.122L8 17.98a3.986 3.986 0 0 1 .333-1.581a9.455 9.455 0 0 1-2.59-1.356C4.106 13.815 3 12.043 3 10c0-1.346.483-2.582 1.284-3.618c-.21-.82-.192-1.648-.112-2.283l.005-.038c.073-.582.158-1.267.566-1.719c.59-.653 1.584-.268 2.28-.031Z"></path>
            </g>
        </svg>`,
        color: '#181717',
        name: 'GitHub'
    },
    javascript: {
        svg: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" style="display: inline-block; vertical-align: middle; margin-right: 6px;">
            <path fill="#F7DF1E" d="M0 0h24v24H0V0zm22.034 18.276c-.175-1.095-.888-2.015-3.003-2.873c-.736-.345-1.554-.585-1.797-1.14c-.091-.33-.105-.51-.046-.705c.15-.646.915-.84 1.515-.66c.39.12.75.42.976.9c1.034-.676 1.034-.676 1.755-1.125c-.27-.42-.404-.601-.586-.78c-.637-.79-1.484-1.19-2.849-1.155l-.711.135c-.688.185-1.341.594-1.637 1.145c-1.17 1.075-.83 2.955.59 3.73c1.395.78 3.445.96 3.71 1.695c.267.855-.3 1.325-1.246 1.385c-1.054.104-1.568-.395-2.176-1.14l-1.84 1.06c.216.49.453.689.81 1.109c1.74 1.756 6.09 1.666 6.871-1.004c.029-.09.24-.705.074-1.65l.046.067zm-8.983-7.245h-2.248c0 1.938-.009 3.864-.009 5.805c0 1.232.063 2.363-.138 2.711c-.33.689-1.18.601-1.566.48c-.396-.196-.597-.466-.83-.855c-.063-.105-.11-.196-.127-.196l-1.825 1.125c.305.63.75 1.172 1.324 1.517c.855.51 2.004.675 3.207.405c.783-.226 1.458-.691 1.811-1.411c.51-.93.402-2.07.397-3.346c.012-2.054 0-4.109 0-6.179l.004-.056z"></path>
        </svg>`,
        color: '#F7DF1E',
        name: 'JavaScript'
    },
    typescript: {
        svg: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" style="display: inline-block; vertical-align: middle; margin-right: 6px;">
            <path fill="#3178C6" d="M1.125 0C.502 0 0 .502 0 1.125v21.75C0 23.498.502 24 1.125 24h21.75c.623 0 1.125-.502 1.125-1.125V1.125C24 .502 23.498 0 22.875 0zm17.363 9.75c.612 0 1.154.037 1.627.111a6.38 6.38 0 0 1 1.306.34v2.458a3.95 3.95 0 0 0-.643-.361a5.093 5.093 0 0 0-.717-.26a5.453 5.453 0 0 0-1.426-.2c-.3 0-.573.028-.819.086a2.1 2.1 0 0 0-.623.242c-.17.104-.3.229-.393.374a.888.888 0 0 0-.14.49c0 .196.053.373.156.529c.104.156.252.304.443.444s.423.276.696.41c.273.135.582.274.926.416c.47.197.892.407 1.266.628c.374.222.695.473.963.753c.268.279.472.598.614.957c.142.359.214.776.214 1.253c0 .657-.125 1.21-.373 1.656a3.033 3.033 0 0 1-1.012 1.085a4.38 4.38 0 0 1-1.487.596c-.566.12-1.163.18-1.79.18a9.916 9.916 0 0 1-1.84-.164a5.544 5.544 0 0 1-1.512-.493v-2.63a5.033 5.033 0 0 0 3.237 1.2c.333 0 .624-.03.872-.09c.249-.06.456-.144.623-.25c.166-.108.29-.234.373-.38a1.023 1.023 0 0 0-.074-1.089a2.12 2.12 0 0 0-.537-.5a5.597 5.597 0 0 0-.807-.444a27.72 27.72 0 0 0-1.007-.436c-.918-.383-1.602-.852-2.053-1.405c-.45-.553-.676-1.222-.676-2.005c0-.614.123-1.141.369-1.582c.246-.441.58-.804 1.004-1.089a4.494 4.494 0 0 1 1.47-.629c.578-.132 1.198-.198 1.858-.198zm-13.858.196h9.04v1.98h-3.675v10.29h-1.69V11.93h-3.675z"></path>
        </svg>`,
        color: '#3178C6',
        name: 'TypeScript'
    },
    linkedin: {
        svg: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" style="display: inline-block; vertical-align: middle; margin-right: 6px;">
            <g fill="none" fillRule="evenodd">
                <path fill="#0A66C2" d="M18 3a3 3 0 0 1 3 3v12a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3zM8 10a1 1 0 0 0-1 1v5a1 1 0 1 0 2 0v-5a1 1 0 0 0-1-1m3-1a1 1 0 0 0-1 1v6a1 1 0 1 0 2 0v-3.66c.305-.344.82-.748 1.393-.993c.333-.142.834-.2 1.182-.09a.55.55 0 0 1 .293.188c.052.07.132.226.132.555v4a1 1 0 0 0 2 0v-4c0-.67-.17-1.266-.524-1.744a2.54 2.54 0 0 0-1.301-.907c-.902-.283-1.901-.126-2.568.16a5.82 5.82 0 0 0-.623.312A1 1 0 0 0 11 9M8 7a1 1 0 1 0 0 2a1 1 0 0 0 0-2"></path>
            </g>
        </svg>`,
        color: '#0A66C2',
        name: 'LinkedIn'
    },
    twitter: {
        svg: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" style="display: inline-block; vertical-align: middle; margin-right: 6px;">
            <g fill="none" fillRule="evenodd">
                <path fill="#000000" d="M19.753 4.659a1 1 0 0 0-1.506-1.317l-5.11 5.84L8.8 3.4A1 1 0 0 0 8 3H4a1 1 0 0 0-.8 1.6l6.437 8.582l-5.39 6.16a1 1 0 0 0 1.506 1.317l5.11-5.841L15.2 20.6a1 1 0 0 0 .8.4h4a1 1 0 0 0 .8-1.6l-6.437-8.582l5.39-6.16ZM16.5 19L6 5h1.5L18 19z"></path>
            </g>
        </svg>`,
        color: '#000000',
        name: 'X (Twitter)'
    },
    x: {
        svg: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" style="display: inline-block; vertical-align: middle; margin-right: 6px;">
            <g fill="none" fillRule="evenodd">
                <path fill="#000000" d="M19.753 4.659a1 1 0 0 0-1.506-1.317l-5.11 5.84L8.8 3.4A1 1 0 0 0 8 3H4a1 1 0 0 0-.8 1.6l6.437 8.582l-5.39 6.16a1 1 0 0 0 1.506 1.317l5.11-5.841L15.2 20.6a1 1 0 0 0 .8.4h4a1 1 0 0 0 .8-1.6l-6.437-8.582l5.39-6.16ZM16.5 19L6 5h1.5L18 19z"></path>
            </g>
        </svg>`,
        color: '#000000',
        name: 'X'
    },
    django: {
        svg: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" style="display: inline-block; vertical-align: middle; margin-right: 6px;">
            <path fill="#092E20" d="M11.146 0h3.924v18.166c-2.013.382-3.491.535-5.096.535-4.791 0-7.288-2.166-7.288-6.32 0-4.002 2.65-6.6 6.753-6.6.637 0 1.121.051 1.707.204zm0 9.143c-.535-.204-.917-.255-1.427-.255-2.114 0-3.313 1.274-3.313 3.57 0 2.245 1.146 3.442 3.313 3.442.51 0 .815-.051 1.427-.204zM16.541 5.936v8.04c0 2.728-.178 4.026-.687 5.15-.484 1.097-1.173 1.856-2.780 2.728L9.84 20.249c1.554-.815 2.268-1.53 2.727-2.779.484-1.248.687-2.701.687-5.835V5.936z"></path>
        </svg>`,
        color: '#092E20',
        name: 'Django'
    },
    bash: {
        svg: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" style="display: inline-block; vertical-align: middle; margin-right: 6px;"><path fill="#4EAA25" d="M12.05 2.852c1.83 0 3.27 0 4.41.12c1.17.12 2.11.38 2.92.97c.49.35.92.78 1.27 1.27c.59.81.85 1.76.98 2.92c.12 1.14.12 2.58.12 4.42v.09c0 1.84 0 3.28-.12 4.42c-.13 1.17-.39 2.11-.98 2.92c-.35.49-.78.92-1.27 1.27c-.81.58-1.75.84-2.92.97c-1.14.12-2.58.12-4.41.12h-.1c-1.83 0-3.27 0-4.41-.12c-1.17-.12-2.11-.38-2.92-.97c-.49-.35-.92-.78-1.27-1.27c-.59-.81-.85-1.76-.98-2.92c-.12-1.14-.12-2.58-.12-4.42v-.09c0-1.84 0-3.28.12-4.42c.13-1.17.39-2.11.98-2.92c.35-.49.78-.92 1.27-1.27c.81-.58 1.75-.84 2.92-.97c1.14-.12 2.58-.12 4.41-.12zM5.5 5.162c-.36.26-.68.58-.94.94c-.37.51-.58 1.16-.69 2.2c-.12 1.05-.12 2.41-.12 4.3s0 3.25.12 4.3c.11 1.04.32 1.69.69 2.2c.26.36.58.68.94.94c.51.37 1.16.59 2.2.7c1.05.12 2.41.12 4.3.12s3.25-.01 4.3-.12c1.04-.12 1.69-.33 2.2-.7c.36-.26.68-.58.94-.94c.37-.51.58-1.16.7-2.2c.11-1.05.11-2.41.11-4.3s0-3.25-.11-4.3c-.12-1.04-.33-1.69-.7-2.2c-.26-.36-.58-.68-.94-.94c-.51-.37-1.16-.59-2.2-.7c-1.05-.12-2.41-.12-4.3-.12s-3.25.01-4.3.12c-1.04.12-1.69.33-2.2.7m.93 1.95c.27-.31.75-.35 1.06-.08l1.23 1.06l.03.03c.23.2.46.39.62.58c.18.2.38.5.38.9s-.2.7-.38.9c-.16.18-.39.38-.62.58l-.03.03l-1.23 1.06c-.31.27-.79.24-1.06-.08a.757.757 0 0 1 .08-1.06l1.23-1.06c.2-.17.33-.29.42-.38c-.09-.09-.22-.2-.42-.38l-1.23-1.06a.756.756 0 0 1-.08-1.06zm3.82 4.49c0-.41.34-.75.75-.75h3c.41 0 .75.34.75.75s-.34.75-.75.75h-3c-.41 0-.75-.34-.75-.75" color="#4EAA25"/></svg>`,
        color: '#4EAA25',
        name: 'Bash'
    },
    c: {
        svg: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 32 32" style="display: inline-block; vertical-align: middle; margin-right: 6px;"><path fill="#a9b9cb" d="M29 10.232a2.4 2.4 0 0 0-.318-1.244a2.45 2.45 0 0 0-.936-.879q-5.194-2.868-10.393-5.733a2.64 2.64 0 0 0-2.763.024c-1.378.779-8.275 4.565-10.331 5.706A2.29 2.29 0 0 0 3 10.231V21.77a2.4 2.4 0 0 0 .3 1.22a2.43 2.43 0 0 0 .954.9c2.056 1.141 8.954 4.927 10.332 5.706a2.64 2.64 0 0 0 2.763.026q5.19-2.871 10.386-5.733a2.44 2.44 0 0 0 .955-.9a2.4 2.4 0 0 0 .3-1.22V10.232"/><path fill="#8b97a3" d="M28.549 23.171a2 2 0 0 0 .147-.182a2.4 2.4 0 0 0 .3-1.22V10.232a2.4 2.4 0 0 0-.318-1.244c-.036-.059-.089-.105-.13-.16L16 16Z"/><path fill="#7f8b99" d="M28.549 23.171L16 16L3.451 23.171a2.4 2.4 0 0 0 .809.72c2.056 1.141 8.954 4.927 10.332 5.706a2.64 2.64 0 0 0 2.763.026q5.19-2.871 10.386-5.733a2.4 2.4 0 0 0 .808-.719"/><path fill="#fff" d="M19.6 18.02a4.121 4.121 0 1 1-.027-4.087l3.615-2.073A8.309 8.309 0 0 0 7.7 16a8.2 8.2 0 0 0 1.1 4.117a8.319 8.319 0 0 0 14.411-.017z"/></svg>`,
        color: '#A8B9CC',
        name: 'C'
    },
    docker: {
        svg: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" style="display: inline-block; vertical-align: middle; margin-right: 6px;">
            <path fill="#2496ED" d="M13.983 11.078h2.119a.186.186 0 0 0 .186-.185V9.006a.186.186 0 0 0-.186-.186h-2.119a.185.185 0 0 0-.185.185v1.888c0 .102.083.185.185.185m-2.954-5.43h2.118a.186.186 0 0 0 .186-.186V3.574a.186.186 0 0 0-.186-.185h-2.118a.185.185 0 0 0-.185.185v1.888c0 .102.082.185.185.186m0 2.716h2.118a.187.187 0 0 0 .186-.186V6.29a.186.186 0 0 0-.186-.185h-2.118a.185.185 0 0 0-.185.185v1.888c0 .102.082.185.185.186m-2.93 0h2.12a.186.186 0 0 0 .184-.186V6.29a.185.185 0 0 0-.185-.185H8.1a.185.185 0 0 0-.185.185v1.888c0 .102.083.185.185.186m-2.964 0h2.119a.186.186 0 0 0 .185-.186V6.29a.185.185 0 0 0-.185-.185H5.136a.186.186 0 0 0-.186.185v1.888c0 .102.084.185.186.186m5.893 2.715h2.118a.186.186 0 0 0 .186-.185V9.006a.186.186 0 0 0-.186-.186h-2.118a.185.185 0 0 0-.185.185v1.888c0 .102.082.185.185.185m-2.93 0h2.12a.185.185 0 0 0 .184-.185V9.006a.185.185 0 0 0-.184-.186h-2.12a.185.185 0 0 0-.184.185v1.888c0 .102.083.185.185.185m-2.964 0h2.119a.185.185 0 0 0 .185-.185V9.006a.185.185 0 0 0-.184-.186H5.136a.186.186 0 0 0-.186.186v1.887c0 .102.084.185.186.185m-2.92 0h2.12a.185.185 0 0 0 .184-.185V9.006a.185.185 0 0 0-.184-.186h-2.12a.185.185 0 0 0-.184.185v1.888c0 .102.083.185.185.185M23.763 9.89c-.065-.051-.672-.51-1.954-.51-.338 0-.676.033-1.01.098-.31-1.128-.995-2.142-2.94-2.142h-.88c-.04 0-.075.025-.094.061-.293.573-.405 1.268-.315 2.005.046.38.181.766.315 1.132.134.326.288.635.288.99 0 .732-.472 1.01-1.039 1.01H.632c-.34 0-.631.255-.631.596 0 1.406.52 2.572 1.529 3.451.845.734 1.956 1.108 3.298 1.108.148 0 .297-.004.446-.012 1.479-.069 2.874-.538 3.902-1.329 1.028-.79 1.669-1.87 1.669-3.097V13.91h.632c.296 0 .572-.04.825-.12.38-.12.728-.312 1.039-.594.264-.24.485-.542.63-.889.096-.240.138-.497.138-.776 0-.408-.132-.8-.288-1.132.9-.361 1.291-.9 1.387-1.265.056-.209.056-.434-.01-.645-.039-.122-.117-.226-.221-.298z"></path>
        </svg>`,
        color: '#2496ED',
        name: 'Docker'
    },
    nuxt: {
        svg: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 32 32" style="display: inline-block; vertical-align: middle; margin-right: 6px;"><!-- Icon from VSCode Icons by Roberto Huertas - https://github.com/vscode-icons/vscode-icons/blob/master/LICENSE --><path fill="#00DC82" d="M17.708 25h10.409c.33 0 .655-.088.942-.254a1.9 1.9 0 0 0 .689-.696a1.91 1.91 0 0 0 0-1.9L22.756 9.936a1.87 1.87 0 0 0-3.261 0l-1.788 3.125l-3.494-6.111a1.871 1.871 0 0 0-3.262 0l-8.7 15.2a1.91 1.91 0 0 0 .69 2.595c.286.167.61.255.941.255h6.534c2.589 0 4.498-1.147 5.811-3.385l3.19-5.572l1.708-2.982l5.127 8.957h-6.835zm-7.398-2.985l-4.56-.001l6.836-11.942l3.41 5.97l-2.283 3.992c-.873 1.452-1.864 1.981-3.403 1.981"/></svg>`,
        color: '#00DC82',
        name: 'Nuxt.js'
    },
    postgreSQL: {
        svg: `<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 14 14" style="display: inline-block; vertical-align: middle; margin-right: 6px;"><g fill="none" stroke="#336791" stroke-linecap="round" stroke-linejoin="round"><ellipse cx="7" cy="3" rx="6.5" ry="2.5"/><path d="M.5 3v8c0 1.38 2.91 2.5 6.5 2.5s6.5-1.12 6.5-2.5V3"/><path d="M13.5 7c0 1.38-2.91 2.5-6.5 2.5S.5 8.38.5 7"/></g></svg>`,
        color: '#336791',
        name: 'PostgreSQL'
    }
}

// Terminal-style icons for technologies using custom SVG content
const getTerminalIcon = (techName: string): string => {
    const normalizedName = techName.toLowerCase().trim()
    const iconConfig = customSvgIcons[normalizedName]

    if (iconConfig) {
        return `${iconConfig.svg}<span style="color: ${iconConfig.color}; font-weight: 500;">${iconConfig.name}</span>`
    }

    // Fallback for unmapped technologies
    return `<span style="color: #888; margin-right: 6px;">•</span> ${techName}`
}

onMounted(async () => {
    // Detect mobile device
    isMobile.value = detectMobile()

    // Load saved theme
    const savedTheme = localStorage.getItem('terminal-theme')
    if (savedTheme && savedTheme in themes) {
        currentTheme.value = savedTheme
    }

    // Start wave animation
    const waveInterval = setInterval(() => {
        currentWaveFrame.value = (currentWaveFrame.value + 1) % waveFrames.length
    }, 200)

    // Show loading animation for 3 seconds
    await new Promise((resolve) => setTimeout(resolve, 3000))

    // Stop wave animation and hide loading
    clearInterval(waveInterval)
    isLoading.value = false

    // Add event listeners after loading
    document.addEventListener('keydown', handleKeyPress)
    window.addEventListener('resize', handleResize)

    // Welcome sequence
    await new Promise((resolve) => setTimeout(resolve, 300))
    terminalHistory.value.push({
        content: "Welcome to imggion's Space",
        isHtml: false,
        isCommand: false
    })
    terminalHistory.value.push({
        content: '=====================================',
        isHtml: false,
        isCommand: false
    })
    terminalHistory.value.push({ content: '', isHtml: false, isCommand: false })
    terminalHistory.value.push({
        content: "Type 'help' to see available commands",
        isHtml: false,
        isCommand: false
    })
    terminalHistory.value.push({ content: '', isHtml: false, isCommand: false })

    // Auto-type help command
    await typeWriter('help')
    executeCommand('help')

    nextTick(() => {
        if (terminalRef.value) {
            terminalRef.value.scrollTop = terminalRef.value.scrollHeight
        }
    })
})

onUnmounted(() => {
    // Remove event listeners before unmounting
    document.removeEventListener('keydown', handleKeyPress)
    window.removeEventListener('resize', handleResize)
})
</script>

<template>
    <!-- Loading Screen -->
    <div
        v-if="isLoading"
        class="loading-container h-screen font-mono text-sm overflow-hidden flex items-center justify-center"
        :style="{ backgroundColor: theme.background, color: theme.text }"
    >
        <div v-if="isMobile" class="text-center px-4" :style="{ color: theme.prompt }">
            <div class="text-2xl mb-4">🌊</div>
            <div class="text-lg mb-2">Giovanni's Portfolio</div>
            <div class="text-sm opacity-75">Loading Terminal...</div>
            <div class="mt-4 text-xs opacity-60">[ASCII Art optimized for desktop viewing]</div>
        </div>
        <pre v-else class="loading-art text-center" :style="{ color: theme.prompt }">{{
            waveFrames[currentWaveFrame]
        }}</pre>
    </div>

    <!-- Terminal -->
    <div
        v-else
        class="terminal-container h-screen font-mono text-sm overflow-hidden"
        :style="{ backgroundColor: theme.background, color: theme.text }"
    >
        <!-- <div
            class="terminal-header px-4 py-2 flex items-center gap-2"
            :style="{ backgroundColor: theme.header }"
        >
            <div class="flex gap-2">
                <div class="w-3 h-3 rounded-full bg-red-500"></div>
                <div class="w-3 h-3 rounded-full bg-yellow-500"></div>
                <div class="w-3 h-3 rounded-full bg-green-500"></div>
            </div>
            <span class="ml-4" :style="{ color: theme.headerText }">giovanni@portfolio: ~</span>
        </div> -->

        <div
            ref="terminalRef"
            class="terminal-content h-full p-4 overflow-y-auto focus:outline-none"
            :style="{
                backgroundColor: theme.background,
                height: 'calc(100vh - 60px)',
                '--scrollbar-color': theme.scrollbar,
                '--scrollbar-hover-color': theme.scrollbarHover,
                '--prompt-color': theme.prompt,
                '--text-color': theme.text
            }"
            @click="focusTerminal"
            tabindex="0"
        >
            <!-- Terminal History -->
            <div
                v-for="(line, index) in terminalHistory"
                :key="index"
                class="terminal-history-item"
                :class="{ 'is-command': line.isCommand }"
            >
                <pre v-if="!line.isHtml" class="whitespace-pre-wrap">{{ line.content }}</pre>
                <pre v-else class="whitespace-pre-wrap" v-html="line.content"></pre>
            </div>

            <!-- Current Input Line -->
            <div class="flex items-center mt-2">
                <span class="mr-2 font-medium" :style="{ color: theme.prompt }"
                    >imggion@portfolio:~$</span
                >
                <span :style="{ color: theme.text }">{{ currentInput }}</span>
                <span
                    class="w-2 h-5 ml-1 animate-pulse"
                    :style="{ backgroundColor: theme.cursor }"
                    :class="{ 'opacity-0': !isTyping }"
                ></span>
            </div>

            <!-- Instructions -->
            <div class="mt-8 text-xs opacity-60">
                <p>Click anywhere and start typing commands...</p>
                <p>
                    Available commands: help, about, projects, skills, contact, clear, whoami, ls,
                    pwd, date, font, theme, themes, icons
                </p>
                <p>Use ↑/↓ arrow keys to navigate command history</p>
            </div>
        </div>
    </div>
</template>

<style scoped>
.terminal-container {
    font-family: 'JetBrains Mono', 'Courier New', 'Monaco', 'Menlo', monospace !important;
    cursor: text;
}

.terminal-container,
.terminal-container * {
    font-family: 'JetBrains Mono', 'Courier New', 'Monaco', 'Menlo', monospace !important;
}

.terminal-content::-webkit-scrollbar {
    width: 8px;
}

.terminal-content::-webkit-scrollbar-track {
    background: transparent;
}

.terminal-content::-webkit-scrollbar-thumb {
    background: var(--scrollbar-color);
    border-radius: 4px;
}

.terminal-content::-webkit-scrollbar-thumb:hover {
    background: var(--scrollbar-hover-color);
}

/* Remove all focus outlines from terminal elements */
.terminal-container,
.terminal-content {
    outline: none !important;
}

.terminal-container:focus,
.terminal-content:focus {
    outline: none !important;
}

/* Terminal link styles */
.terminal-link {
    color: inherit;
    text-decoration: underline;
    text-decoration-color: currentColor;
    transition: opacity 0.2s ease;
}

.terminal-link:hover {
    opacity: 0.8;
    text-decoration: underline;
}

.terminal-link:visited {
    color: inherit;
}

/* Terminal icon styles */
.terminal-history-item svg {
    vertical-align: middle;
    display: inline-block;
}

/* Add subtle spacing between command blocks */
.terminal-history-item {
    margin-bottom: 2px;
}

/* Style for command prompt lines */
.terminal-history-item.is-command {
    margin-top: 12px;
    margin-bottom: 4px;
    position: relative;
}

.terminal-history-item.is-command:first-child {
    margin-top: 0;
}

.terminal-history-item.is-command:not(:first-child):before {
    content: '';
    position: absolute;
    top: -6px;
    left: 0;
    right: 0;
    height: 1px;
    background: currentColor;
    opacity: 0.1;
}

@keyframes blink {
    0%,
    50% {
        opacity: 1;
    }
    51%,
    100% {
        opacity: 0;
    }
}

.animate-blink {
    animation: blink 1s infinite;
}

/* Loading animation styles */
.loading-container {
    animation: fadeIn 0.5s ease-in;
}

.loading-art {
    font-size: 16px;
    line-height: 1.2;
    white-space: pre;
    animation: glow 2s ease-in-out infinite alternate;
}

.terminal-container {
    animation: slideInFromBottom 0.8s ease-out;
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

@keyframes glow {
    from {
        opacity: 0.8;
    }
    to {
        opacity: 1;
    }
}

@keyframes slideInFromBottom {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
</style>
